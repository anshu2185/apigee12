#!groovy
import static groovy.io.FileType.FILES

node {
   echo 'SharedFlow Deployment started...'
  
	stage ('Checkout'){
		checkout scm
	}
	
	stage ('Deploying SharedFlow'){
		def mvnHome = tool 'Maven3.3.9'
	    sh "${mvnHome}/bin/mvn --version"
		echo "${WORKSPACE}"
		dirs = readDir()
	}

}
@NonCPS
def readDir()
{
    def filenames = [];
    def dir = new File("${WORKSPACE}/apigee-codegen");
    dir.traverse(type: FILES, maxDepth: 0) {
        filenames.add(it.getName())
    }

    for (int i = 0; i < filenames.size(); i++) {
        def filename = filenames[i]
        echo "${filename}"
    }
}
